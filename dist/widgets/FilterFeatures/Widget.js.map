{"version":3,"sources":["../../../widgets/FilterFeatures/Widget.js"],"names":["declare","BaseWidget","_WidgetsInTemplateMixin","Query","QueryTask","baseClass","postCreate","inherited","arguments","console","log","startup","config","urlService","departamento","url","clause","valueField","value","labelField","label","attachPoint","depaSelectAttachPoint","_filterFeature","queryTask","query","where","outFields","execute","results","options","i","features","opt","attributes","push"],"mappings":"QAAoB,oB,EACG,iB,EACa,+B,EAClB,kB,EACI,sB,aAJfA,O,EACAC,U,EACAC,uB,EACAC,K,EACAC,S;SAKQJ,QAAQ,CACrBC,UADqB,EAErBC,uBAFqB,EAGrBC,KAHqB,EAIrBC,SAJqB,CAAR,EAID;;AAEZ;;AAEAC,eAAW,iBAJC;;AASZC,cATY,wBASE;AACZ,WAAKC,SAAL,CAAeC,SAAf;AACAC,cAAQC,GAAR,CAAY,4BAAZ;AACD,KAZW;AAcZC,WAdY,qBAcF;AACR,WAAKJ,SAAL,CAAeC,SAAf;AACAC,cAAQC,GAAR,CAAY,yBAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKE,MAAjB;AACAC,mBAAa,KAAKD,MAAL,CAAYE,YAAZ,CAAyBC,GAAtC;AACAC,eAAS,KAAT;AACAC,mBAAa,KAAKL,MAAL,CAAYE,YAAZ,CAAyBI,KAAtC;AACAC,mBAAa,KAAKP,MAAL,CAAYE,YAAZ,CAAyBM,KAAtC;AACAC,oBAAc,KAAKC,qBAAnB;AACA,WAAKC,cAAL,CAAoBV,UAApB,EAAgCG,MAAhC,EAAwCC,UAAxC,EAAoDE,UAApD,EAAgEE,WAAhE;AAED,KAzBW;AA2BZE,kBA3BY,0BA2BGV,UA3BH,EA2BeG,MA3Bf,EA2BuBC,UA3BvB,EA2BmCE,UA3BnC,EA2B+CE,WA3B/C,EA2B2D;AACrE,UAAIG,YAAY,IAAIpB,SAAJ,CAAcS,UAAd,CAAhB;AACA,UAAIY,QAAQ,IAAItB,KAAJ,EAAZ;AACAsB,YAAMC,KAAN,GAAcV,MAAd;AACAS,YAAME,SAAN,GAAkB,CAACV,UAAD,EAAaE,UAAb,CAAlB;AACAK,gBAAUI,OAAV,CAAkBH,KAAlB,EAAyB,UAASI,OAAT,EAAiB;AACxC,YAAIC,UAAU,EAAd;AACA,aAAI,IAAIC,CAAR,IAAaF,QAAQG,QAArB,EAA8B;AAC5B,cAAIC,MAAM;AACR,qBAASJ,QAAQG,QAAR,CAAiBD,CAAjB,EAAoBG,UAApB,CAA+Bf,UAA/B,CADD;AAER,qBAASU,QAAQG,QAAR,CAAiBD,CAAjB,EAAoBG,UAApB,CAA+BjB,UAA/B;AAFD,WAAV;AAIAa,kBAAQK,IAAR,CAAaF,GAAb;AACD;AACDZ,oBAAYS,OAAZ,GAAsBA,OAAtB;AACD,OAVD;AAWD;AA3CW;AA4CZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvEa,G","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\n// import \"dojo/parser\";\r\n// import \"dijit/form/Select\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([\r\n  BaseWidget, \r\n  _WidgetsInTemplateMixin, \r\n  Query, \r\n  QueryTask], {\r\n\r\n  // Custom widget code goes here\r\n\r\n  baseClass: 'filter-features',\r\n\r\n  // add additional properties here\r\n\r\n  // methods to communication with app container:\r\n  postCreate () {\r\n    this.inherited(arguments);\r\n    console.log('FilterFeatures::postCreate');\r\n  },\r\n  \r\n  startup() {\r\n    this.inherited(arguments);\r\n    console.log('FilterFeatures::startup');\r\n    console.log(this.config);\r\n    urlService = this.config.departamento.url;\r\n    clause = '1=1';\r\n    valueField = this.config.departamento.value;\r\n    labelField = this.config.departamento.label;\r\n    attachPoint = this.depaSelectAttachPoint;\r\n    this._filterFeature(urlService, clause, valueField, labelField, attachPoint);\r\n\r\n  },\r\n\r\n  _filterFeature(urlService, clause, valueField, labelField, attachPoint){\r\n    var queryTask = new QueryTask(urlService);\r\n    var query = new Query();\r\n    query.where = clause;\r\n    query.outFields = [valueField, labelField];\r\n    queryTask.execute(query, function(results){\r\n      var options = []\r\n      for(var i in results.features){\r\n        var opt = {\r\n          'label': results.features[i].attributes[labelField],\r\n          'value': results.features[i].attributes[valueField]\r\n        };\r\n        options.push(opt);\r\n      }\r\n      attachPoint.options = options;\r\n    });\r\n  },\r\n  // onOpen() {\r\n  //   console.log('FilterFeatures::onOpen');\r\n  // },\r\n  // onClose(){\r\n  //   console.log('FilterFeatures::onClose');\r\n  // },\r\n  // onMinimize(){\r\n  //   console.log('FilterFeatures::onMinimize');\r\n  // },\r\n  // onMaximize(){\r\n  //   console.log('FilterFeatures::onMaximize');\r\n  // },\r\n  // onSignIn(credential){\r\n  //   console.log('FilterFeatures::onSignIn', credential);\r\n  // },\r\n  // onSignOut(){\r\n  //   console.log('FilterFeatures::onSignOut');\r\n  // }\r\n  // onPositionChange(){\r\n  //   console.log('FilterFeatures::onPositionChange');\r\n  // },\r\n  // resize(){\r\n  //   console.log('FilterFeatures::resize');\r\n  // }\r\n});\r\n"]}